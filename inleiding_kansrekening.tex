%        File: wat_is_kans.tex
%     Created: Sat Nov 24 02:00 PM 2012 C
% Last Change: Sat Nov 24 02:00 PM 2012 C
%
\documentclass[a4paper]{book}
\usepackage{amssymb,amsmath,amsthm,enumerate,graphicx,float,lmodern,xparse, mathtools}
\usepackage[dutch]{babel}
\usepackage{color}

\title{Inleiding Eindige Kansrekening \\ \small{Opgebouwd vanuit de intu\"itieve verzamelingenleer}}
\author{Ch.\ ten Brinke}

\newtheorem{theorem}{Stelling}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Gevolg}
\newtheorem{proposition}[theorem]{Propositie}
\newtheorem{exercise}[theorem]{Opgave}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definitie}
\newtheorem{example}[theorem]{Voorbeeld}
\newtheorem{remark}[theorem]{Opmerking}

\NewDocumentCommand\set{mg}{%
    \ensuremath{\left\lbrace #1 \IfNoValueTF{#2}{}{\, \middle|\, #2} \right\rbrace}%
}
\NewDocumentCommand\powerset{mg}{%
    \ensuremath{\mathcal{P}(#1)}
}
\NewDocumentCommand\compl{mg}{%
    \ensuremath{\bar{#1}}
}
\newcommand{\reals}{\mathbb{R}}


%\definecolor{foo}{rgb}{0.3,0.0,0.3}
%\everymath{\color{foo}}


\begin{document}
\maketitle

\chapter{Algemene Kansruimtes}
Kansrekening is een directe toepassing van verzamelingenleer en analyse.
Het fundamentele concept in de kansrekening is de zogenaamde \emph{kansruimte}.
We zullen alleen eindige kansruimtes beschouwen, omdat dit genoeg intuitie verschaft over de formele constructie van kansrekening zonder dat het al te
technisch wordt.
Daarom duidt het woord kansruimte in het vervolg van dit document altijd een eindige kansruimte aan.



\section{Kansruimte}
Een kansruimte kunnen we informeel beschouwen als een eindige verzameling, waarbij we veronderstellen dat er precies \'e\'en element van deze verzameling `waar is', zonder dat we weten welk element dat is.
Op de machtsverzameling van de kansruimte is een zekere functie gedefinieerd, die we de \emph{kansverdeling} noemen.
Deze kansverdeling noteren we vaak met $P$, en wordt ook wel kansdistributie genoemd.
Een kansverdeling voegt aan elke deelverzameling van de betreffende kansruimte de kans toe dat het element dat `waar is' in die deelverzameling zit.
In de praktijk hoeft een kansverdeling niet altijd volledig bekend te zijn.

\begin{definition}
    Een \emph{kansruimte} $\Omega$ is een eindige verzameling met een \emph{kansverdeling} $P: \Omega \to [0,1]$  die aan de volgende eigenschappen voldoet.
    \begin{enumerate}[i]
        \item $P(x) \geq 0$ voor alle $x \in \Omega$.
        \item $\sum_{x \in \Omega}P(x) = 1$.
    \end{enumerate}

    Een uitdrukking van de vorm $P(x)$ spreken we uit als ``de kans op $x$''.
    Als $P(x)$ hetzelfde is voor alle $x\in \Omega$, dan heet $P$ een \emph{uniforme verdeling}.

    Vaak willen we de kans van een deelverzameling van $\Omega$ uitdrukken, in plaats van de kans van een individueel element.
    Daarom noteren we de kans van een deelverzameling $A \subseteq \Omega$ met $P(A) = \sum_{a \in A} P(a)$.
\end{definition}

Een deelverzameling van een kansruimte is opnieuw een kansruimte, als we de kansverdeling correct induceren.
\begin{proposition}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A \subseteq \Omega$ een deelverzameling.
    Dan is $A$ een kansruimte met kansverdeling $P_A(a) = \frac{P(a)}{P(A)}$.
\end{proposition}
\begin{proof}
    We moeten laten zien dat $P_A$ aan de definitie van de kansverdeling voldoet.
    \begin{enumerate}[i]
        \item Er geldt dat $\sum_{a \in A}P_A(a) = P_A(A) = \frac{P(A)}{P(A)} = 1$.
        \item Voor alle $a \subseteq A$ geldt dat $P_A(a) = \frac{P(a)}{P(A)} \geq 0$, want $P(a) \geq 0$ en $P(A) \geq 0$.
    \end{enumerate}
    Dus $P_A$ is een kansverdeling en daarmee is $A$ een kansruimte.
\end{proof}

\begin{exercise}
    Laat zien dat de verzameling van mogelijke uitkomsten van het gooien van een zeszijdige dobbelsteen een kansruimte vormt met zes elementen.
\end{exercise}

Hieronder volgen een aantal handige resultaten, die direct met de definitie te bewijzen zijn.
\begin{proposition}[Somregel]\label{somregel}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A,B \subseteq \Omega$.
    Dan geldt $P(A \cup B) = P(A) + P(B) - P(A \cap B)$.
    In het bijzonder geldt $P(A \cup B) = P(A) + P(B)$ wanneer $A$ en $B$ disjunct zijn.
\end{proposition}
\begin{proof}
    \begin{align*}
        P(A \cup B)     &= \sum_{x \in A \cup B} P(x) & \text{definitie kansverdeling}\\
                        &= \sum_{x \in A} P(x) + \sum_{x \in B} P(x) - \sum_{x \in A \cap B} P(x) \\
                        &= P(A) + P(B) - P(A \cap B) \\
    \end{align*}
\end{proof}

\begin{proposition}[Verschilregel]\label{verschilregel}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $B \subseteq A \subseteq \Omega$.
    Dan geldt $P(A - B) = P(A) - P(A \cap B) $.
\end{proposition}
\begin{proof}
    We zien
    \begin{align*}
        P(A)    &= P( (A - A \cap B) \cup (A \cap B) ) \\
                &= P(A - A \cap B ) + P(A \cap B) & \text{somregel} \\
                &= P(A - B) + P(A \cap B) \\
    \end{align*}
    dus $P(A - B) = P(A) - P(A \cap B) $.
\end{proof}

\begin{proposition}[Complementregel]\label{complementregel}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A \subseteq \Omega$.
    Noteer met $\compl{A}$ het complement van $A$, i.e.\ $\Omega - A$.
    Dan geldt $P(\compl{A}) = 1 - P(A)$.
\end{proposition}
\begin{proof}
    Er geldt $P(\compl{A}) = P(\Omega - A)$.
    Bovendien
    \begin{align*}
        1 &= P(\Omega) & \text{definitie kansverdeling}\\
          &= P( (\Omega - A) \cup A) \\
          &= P(\Omega - A) + P(A) & \text{somregel}
    \end{align*}
    Dus $P(\compl{A}) = 1 - P(A)$.
\end{proof}


\begin{exercise}
    Zij $\Omega = \set{1,2,3,4,5}$ de verzameling van uitkomsten van het gooien van een vijfzijdige dobbelsteen,
    i.e.\ $P(\set{x}) = \frac{1}{5}$ voor elke $x \in \Omega$.
    Zij $A \subseteq \Omega$ de verzameling van oneven uitkomsten.
    Bewijs dat $P(A) = \frac{3}{5}$.
    Bewijs dat $P(A^c) = \frac{2}{5}$.
\end{exercise}


\section{Voorwaardelijke kans}
Nu kunnen we de notie van voorwaardelijke kans invoeren.
Hierbij beperken we de kansverdeling tot een zekere deelruimte.
We kunnen dit interpreteren alsof we weten dat het `ware element' in deze deelruimte zit.
\begin{definition}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A \subseteq \Omega$ een deelruimte.
    Definieer $P(B|A) = P_A(B) = \frac{P(A \cap B)}{P(B)}$. Dit spreken we uit als `de kans van $B$ gegeven $A$'.
\end{definition}

\begin{definition}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A,B \subseteq \Omega$ twee deelruimtes.
    Dan heten $A$ en $B$ onafhankelijk als $P(A|B) = P(A)$.
\end{definition}

\begin{proposition}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A,B \subseteq \Omega$ twee deelruimtes.
    Er geldt $P(A \cap B) = P(A)P(B)$ precies dan als $A$ en $B$ onafhankelijk zijn.
\end{proposition}
\begin{proof}
    Merk op dat de volgende vergelijkingen equivalent zijn.
    \begin{align*}
        P(A|B)                      &= P(A) & \text{definitie onafhankelijkheid}\\
        \frac{P(A \cap B)}{P(B)}    &= P(A) \\
        P(A \cap B)                 &= P(A)P(B)
    \end{align*}
    Dit bewijst de gevraagde gelijkwaardigheid.
\end{proof}

\begin{proposition}[De regel van Bayes]\label{bayes}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A,B \subseteq \Omega$ twee deelruimtes.
    Dan geldt $P(A|B) = \frac{P(B|A)P(A)}{P(B)}$.
\end{proposition}
\begin{proof}
    Het bewijs is een opgave voor de lezer.
\end{proof}

Het kan ook zo zijn dat twee deelruimtes onafhankelijk zijn als we ze beperken tot een zekere derde deelruimte.
Dit noemen we voorwaardelijke onafhankelijkheid.
\begin{definition}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A,B,C \subseteq \Omega$ drie deelruimtes.
    Dan heten $A$ en $B$ onafhankelijk gegeven $C$ als $P(A|B \cap C) = P(A|C)$.
\end{definition}

\begin{proposition}
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $A,B,C \subseteq \Omega$ drie deelruimtes.
    Er geldt dat $P(A \cap B|C) = P(A|C)P(B|C)$ precies dan als $A$ en $B$ onafhankelijk zijn gegeven $C$.
\end{proposition}
\begin{proof}
    Merk op dat de volgende vergelijkingen equivalent zijn.
    \begin{align*}
        P(A \cap B|C)                       &= P(A|C)P(B|C) \\
        \frac{P(A \cap B \cap C)}{P(C)}     &= \frac{P(A \cap C)}{P(C)} \frac{P(B \cap C)}{P(C)} \\
        P(A \cap B \cap C)P(C)              &= P(A \cap C)P(B \cap C) \\
        P(A \cap B \cap C)P(B \cap C)       &= P(A \cap C)P(C) \\
        P(A | B \cap C)                     &= P(A | C)
    \end{align*}
    Dit bewijst de gevraagde gelijkwaardigheid.
\end{proof}


\begin{exercise}
    Zij $\Omega = \set{1,\dots,20}$ de verzameling van uitkomsten van het gooien van een twintigzijdige dobbelsteen.
    Zij $A \subseteq \Omega$ de verzameling van oneven uitkomsten.
    Bereken de volgende uitdrukkingen.
    \begin{enumerate}[a.]
        \item $P(A)$
        \item $P(\set{5}|A)$
        \item $P(\set{1,\dots,10}|A)$
        \item $P(A|\set{4})$
        \item $P(A|\set{5})$
        \item $P(A|\set{1,\dots,7})$
    \end{enumerate}
\end{exercise}

\begin{exercise}
Wat is de kans om vier maal op een rij het getal 1 te gooien met een zeszijdige dobbelsteen?
\end{exercise}

\begin{exercise}
    Bewijs Propositie~\ref{bayes}.
\end{exercise}

\begin{exercise}
In een groep van 30 studenten, zeven hebben het huiswerk niet gemaakt. De docent kies willekeurig zes studenten.
Wat is de kans dat tenminste vier van hen het huiswerk niet hebben gemaakt?
\end{exercise}

\begin{exercise}
Er zitten 30 artikelen in een doos. Daarvan zijn er drie beschadigd.
5 willekeurige artikelen worden uit de doos gehaald. Wat is de kans dat hoogstens twee daarvan beschadigd zijn?
\end{exercise}


\section{Verzamelingen van kansruimtes}
We kunnen een aantal proposities generaliseren voor verzamelingen van kansruimtes.

\begin{proposition}[kettingregel]
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $(X_i), 0 \leq i \leq n$ een rij deelruimtes van $\Omega$.
    Dan geldt $P(X_0 \cap \dots \cap X_n) = P(X_0|X_1 \cap \dots \cap X_n) \dots P(X_{n-1}|X_n)P(X_n)$.
\end{proposition}
\begin{proof}
    Het bewijs is een opgave voor de lezer.
\end{proof}

\begin{proposition}[marginale kans]
    Laat $\Omega$ een kansruimte met kansverdeling $P$ en $X \subseteq \Omega$ een deelruimtes.
    Laat bovendien $(Y_i), 0 \leq i \leq n$ een partitie van $\Omega$.
    Dan geldt $P(X) = \sum_{i=0}^n P(X \cap Y_i)$.
\end{proposition}
\begin{proof}
    Het bewijs is een opgave voor de lezer.
\end{proof}


\section{Functies op kansruimtes}
Gegeven een kansruimte en een functie op die kansruimte, kan er een nieuwe kansruimte geconstrueerd worden.

\begin{definition}[morfisme]\label{morfisme}
    Laat $X$ een kansruimte met kansverdeling $P_X$, $Y$ een verzameling en $\phi : X \to Y$ een surjectieve functie.
    De functie $\phi$ heet een \emph{morfisme} van $X$ naar $Y$.

    Omdat $\phi$ niet noodzakelijkerwijs injectief heeft deze niet altijd een inverse.
    Echter, omdat $\phi$ surjectief is, kunnen we wel een pseudo-inverse defini\"eren die de elementen in $Y$ afbeeldt op de verzameling van alle originelen.
    We defini\"eren daarom de pseudo-inverse van $\phi$, genoteerd met $\phi^{-1}$, als volgt.
    Laat $\phi^{-1} : Y \to \powerset{X}$ waarbij $\phi^{-1}(y) = \set{x : \phi(X) = y}{x \in X}$.

    Als $\phi$ bijectief is noemen we $\phi$ ook wel een \emph{isomorfisme}.
    Als er een isomorfisme bestaat tussen twee kansruimtes $X$ en $Y$, dan noemen we $X$ en $Y$ isomorf.
\end{definition}

\begin{proposition}
    Er geldt dat $Y$ uit Definitie~\ref{morfisme} via de morfisme $\phi$ opnieuw een kansruimte is, met een kansverdeling $P_Y(y) = P_X(\phi^{-1}(y))$.
\end{proposition}
\begin{proof}
    We moeten laten zien dat $P_Y$ aan de definitie van een kansverdeling voldoet.

    \begin{enumerate}[i]
        \item Laat $y \in Y$. Dan geldt $P_Y(y) =  P_X(\phi^{-1}(y)) \geq 0$.
        \item Per definitie weten we dat
        \begin{align*}
            P_Y(Y) &= \sum_{y \in Y} P_Y(y) \\
                   &= \sum_{y \in Y} P_X(\phi^{-1}(y)) \\
                   &= \sum_{y \in Y} \sum_{x \in \phi^{-1}(y)} P_X(x) \\
        \end{align*}
        Omdat $\phi$ een functie is weten we dat elk element uit $X$ precies eenmaal voorkomt in een zeker element uit het beeld van $\phi^{-1}$.
        Dus \[ \sum_{y \in Y} \sum_{x \in \phi^{-1}(y)} P_X(x) = \sum_{x \in X} P_X(x) = P(X) = 1. \]
    \end{enumerate}
\end{proof}


\section{Cartesisch product tussen kansruimtes}


%\begin{exercise}
%Student A, B en C doen een drankje in de stad, en moeten bepalen wie er bobt.
%Ze komen overeen een munt op te gooien om te bepalen welk van de drie deze taak op zich zal nemen.
%Ze hebben echter maar 1 munt met 2 zijden, terwijl ze met 3 personen zijn. Student C stelt het volgende voor. De munt moet herhaaldelijk worden opgegooid
%totdat 1 van de volgende situaties zich voordoet: als er op enig moment tweemaal achtereenvolgens munt boven komt dan wint student A, als tweemaal
%achtereenvolgens kop boven komt wint student B, en als er eenmaal kop boven komt en direct daarna munt boven komt dan wint student C. Doet student A er
%verstandig aan akkoord te gaan met het voorstel van student C?
%\end{exercise}


% TODO: maak alles eindig

\chapter{Stochastische variabelen}
Als de elementen van een kansruimte uit te drukken zijn in een getal, dan kunnen we bepaalde numerieke eigenschappen uitrekenen.
Een stochastische variabele is een kansruimte samen met een morfisme naar een deelverzameling van $\reals$.

\begin{definition}
    Laat $\Omega$ een kansruimte met kansverdeling $P$, en laat $X \subseteq \reals$ en $\phi : \Omega \to X$ een morfisme.
    Dan heet het paar $(\Omega,\phi)$ een \emph{stochastische variabele}, of \emph{stochast}.
\end{definition}

Omdat we de elementen van een stochast in getallen kunnen uitdrukken, kunnen spreken de `verwachte waarde' van een stochast.
Dit is het gemiddelde van alle elementen, gewogen door kun kans.

\begin{definition}
    Laat $S = (\Omega,\phi)$ een stochast.
    Definieer \[ \mu(S) = \sum_{x \in \Omega} \phi(x) \cdot P(x). \]
    Dan heet $\mu(S)$ de verwachte waarde van $S$.
\end{definition}

In andere literatuur wordt vaak het symbool $E$ gebruikt in plaats van $\mu$.
We kunnen spreken over een standaard deviatie van een stochast. Dit is te interpreteren als de verwachte afwijking van de verwachte waarde.

\begin{definition}
    Laat $S = (\Omega,\phi)$ een stochast.
    Definieer \[ \sigma(S) = \sum_{x \in \Omega} |\phi(x) - \mu(S)| \cdot P(x) \]
    Dan heet $\sigma(S)$ de standaard deviatie van $S$.
\end{definition}

Omdat de standaard deviatie in de praktijk onhandige algebraische eigenschappen heeft, wordt in plaats van standaard deviatie vaak variantie gebruikt.

\begin{definition}
    Laat $S = (\Omega,\phi)$ een stochast.
    Definieer \[ \sigma^2(S) = \sum_{x \in \Omega} (\phi(x) - \mu(S))^2 \cdot P(x) \]
    Dan heet $\sigma^2(S)$ de variantie van $S$.
\end{definition}



%\chapter{Specifieke kansruimtes}
%We zullen kansruimtes beschouwen waarbij we extra eigenschappen van de kansruimte en de bijbehorende kansverdeling veronderstellen.
%Bij het toepassen van kansrekening op concrete problemen, is er vaak meer bekend over kansverdelingen, zodat kennis van specifieke veelvoorkomende kansruimtes veel gebruikt kan worden.

%Belangrijke verdelingen hebben een naam, zoals de Bernoulli verdeling en de binomiale verdeling.
%
%Bij een event A bestaande uit een opeenvolging van andere events, kunnen we A visualiseren door een boom diagram te tekenen.
%Hierdoor kunnen we er intuitiever mee redeneren, zodat we vragen omtrent A makkelijker kunnen beantwoorden.
%
%Een willekeurige variabele is een kansruimte.
%Men kan een (universele) kansruimte naar een andere kansruimte sturen via een functie.
%Als een zekere kansruimte A 5 dobbelsteenworpen beschrijft, dan kunnen we een functie f: A->N definiëren die alle ogen optelt.
%De resulterende kansruimte f(A) beschrijft dan het totaal aantal ogen.
%
%Een joint verdeling van kansruimtes A en B is het cartesisch product AxB.
%Ook hierbij kunnen we verzamelingenleer nog steeds volledig gebruiken.
\end{document}


